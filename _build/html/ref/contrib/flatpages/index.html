

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The flatpages app &mdash; Django 1.10.dev20160423182652 文档</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Django 1.10.dev20160423182652 文档" href="../../../"/>
        <link rel="up" title="contrib packages" href="../"/>
        <link rel="next" title="GeoDjango" href="../gis/"/>
        <link rel="prev" title="The contenttypes framework" href="../contenttypes/"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../contents/" class="icon icon-home"> Django
          

          
          </a>

          
            
            
              <div class="version">
                1.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../">Django 最新中文文档</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro/">开始</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../topics/">Using Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/">&#8220;How-to&#8221; guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/">Django FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../applications/">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../checks/">System check framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class-based-views/">Built-in class-based views API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../clickjacking/">Clickjacking Protection</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../"><code class="docutils literal"><span class="pre">contrib</span></code> packages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../admin/">The Django admin site</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auth/"><code class="docutils literal"><span class="pre">django.contrib.auth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../contenttypes/">The contenttypes framework</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">The flatpages app</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-add-change-and-delete-flatpages">How to add, change and delete flatpages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flatpage-templates">Flatpage templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-a-list-of-flatpage-objects-in-your-templates">Getting a list of <code class="docutils literal"><span class="pre">FlatPage</span></code> objects in your templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integrating-with-django-contrib-sitemaps">Integrating with <code class="docutils literal"><span class="pre">django.contrib.sitemaps</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gis/">GeoDjango</a></li>
<li class="toctree-l3"><a class="reference internal" href="../humanize/"><code class="docutils literal"><span class="pre">django.contrib.humanize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../messages/">The messages framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../postgres/"><code class="docutils literal"><span class="pre">django.contrib.postgres</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../redirects/">The redirects app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sitemaps/">The sitemap framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sites/">The &#8220;sites&#8221; framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../staticfiles/">The <code class="docutils literal"><span class="pre">staticfiles</span></code> app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../syndication/">The syndication feed framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../#admin"><code class="docutils literal"><span class="pre">admin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#auth"><code class="docutils literal"><span class="pre">auth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#contenttypes"><code class="docutils literal"><span class="pre">contenttypes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#flatpages"><code class="docutils literal"><span class="pre">flatpages</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#gis"><code class="docutils literal"><span class="pre">gis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#humanize"><code class="docutils literal"><span class="pre">humanize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#messages"><code class="docutils literal"><span class="pre">messages</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#postgres"><code class="docutils literal"><span class="pre">postgres</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#redirects"><code class="docutils literal"><span class="pre">redirects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#sessions"><code class="docutils literal"><span class="pre">sessions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#sites"><code class="docutils literal"><span class="pre">sites</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#sitemaps"><code class="docutils literal"><span class="pre">sitemaps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#syndication"><code class="docutils literal"><span class="pre">syndication</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../#other-add-ons">Other add-ons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../csrf/">Cross Site Request Forgery protection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../databases/">Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../django-admin/"><code class="docutils literal"><span class="pre">django-admin</span></code> and <code class="docutils literal"><span class="pre">manage.py</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../django-admin/#running-management-commands-from-your-code">Running management commands from your code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exceptions/">Django Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../files/">File handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../forms/">Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../middleware/">Middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../migration-operations/">Migration Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../request-response/">Request and response objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../schema-editor/"><code class="docutils literal"><span class="pre">SchemaEditor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../settings/">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../signals/">Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../templates/">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../template-response/"><code class="docutils literal"><span class="pre">TemplateResponse</span></code> and <code class="docutils literal"><span class="pre">SimpleTemplateResponse</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../unicode/">Unicode data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../urlresolvers/"><code class="docutils literal"><span class="pre">django.urls</span></code> utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../urls/"><code class="docutils literal"><span class="pre">django.conf.urls</span></code> utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utils/">Django Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../validators/">Validators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../views/">Built-in Views</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/">元文件和杂记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../internals/">Django internals</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../contents/">Django</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../contents/">Docs</a> &raquo;</li>
      
          <li><a href="../../">API Reference</a> &raquo;</li>
      
          <li><a href="../"><code class="docutils literal"><span class="pre">contrib</span></code> packages</a> &raquo;</li>
      
    <li>The flatpages app</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/ref/contrib/flatpages.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="s-module-django.contrib.flatpages">
<span id="s-the-flatpages-app"></span><span id="module-django.contrib.flatpages"></span><span id="the-flatpages-app"></span><h1>The flatpages app<a class="headerlink" href="#module-django.contrib.flatpages" title="永久链接至标题">¶</a></h1>
<p>Django comes with an optional &#8220;flatpages&#8221; application. It lets you store simple
&#8220;flat&#8221; HTML content in a database and handles the management for you via
Django&#8217;s admin interface and a Python API.</p>
<p>A flatpage is a simple object with a URL, title and content. Use it for
one-off, special-case pages, such as &#8220;About&#8221; or &#8220;Privacy Policy&#8221; pages, that
you want to store in a database but for which you don&#8217;t want to develop a
custom Django application.</p>
<p>A flatpage can use a custom template or a default, systemwide flatpage
template. It can be associated with one, or multiple, sites.</p>
<p>The content field may optionally be left blank if you prefer to put your
content in a custom template.</p>
<p>Here are some examples of flatpages on Django-powered sites:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.lawrence.com/about/contact/">http://www.lawrence.com/about/contact/</a></li>
<li><a class="reference external" href="http://www2.ljworld.com/site/rules/">http://www2.ljworld.com/site/rules/</a></li>
</ul>
<div class="section" id="s-installation">
<span id="installation"></span><h2>Installation<a class="headerlink" href="#installation" title="永久链接至标题">¶</a></h2>
<p>To install the flatpages app, follow these steps:</p>
<ol class="arabic">
<li><p class="first">Install the <a class="reference internal" href="../sites/#module-django.contrib.sites" title="django.contrib.sites: Lets you operate multiple websites from the same database and Django project"><code class="xref py py-mod docutils literal"><span class="pre">sites</span> <span class="pre">framework</span></code></a> by adding
<code class="docutils literal"><span class="pre">'django.contrib.sites'</span></code> to your <a class="reference internal" href="../../settings/#std:setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></code></a> setting,
if it&#8217;s not already in there.</p>
<p>Also make sure you&#8217;ve correctly set <a class="reference internal" href="../../settings/#std:setting-SITE_ID"><code class="xref std std-setting docutils literal"><span class="pre">SITE_ID</span></code></a> to the ID of the
site the settings file represents. This will usually be <code class="docutils literal"><span class="pre">1</span></code> (i.e.
<code class="docutils literal"><span class="pre">SITE_ID</span> <span class="pre">=</span> <span class="pre">1</span></code>, but if you&#8217;re using the sites framework to manage
multiple sites, it could be the ID of a different site.</p>
</li>
<li><p class="first">Add <code class="docutils literal"><span class="pre">'django.contrib.flatpages'</span></code> to your <a class="reference internal" href="../../settings/#std:setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></code></a>
setting.</p>
</li>
</ol>
<p>Then either:</p>
<ol class="arabic" start="3">
<li><p class="first">Add an entry in your URLconf. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^pages/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;django.contrib.flatpages.urls&#39;</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
<p>or:</p>
<ol class="arabic simple" start="3">
<li>Add <code class="docutils literal"><span class="pre">'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'</span></code>
to your <a class="reference internal" href="../../settings/#std:setting-MIDDLEWARE_CLASSES"><code class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></code></a> setting.</li>
<li>Run the command <a class="reference internal" href="../../django-admin/#django-admin-migrate"><code class="xref std std-djadmin docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></code></a>.</li>
</ol>
</div>
<div class="section" id="s-how-it-works">
<span id="how-it-works"></span><h2>How it works<a class="headerlink" href="#how-it-works" title="永久链接至标题">¶</a></h2>
<p><code class="docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></code> creates two tables in your database: <code class="docutils literal"><span class="pre">django_flatpage</span></code>
and <code class="docutils literal"><span class="pre">django_flatpage_sites</span></code>. <code class="docutils literal"><span class="pre">django_flatpage</span></code> is a simple lookup table
that simply maps a URL to a title and bunch of text content.
<code class="docutils literal"><span class="pre">django_flatpage_sites</span></code> associates a flatpage with a site.</p>
<div class="section" id="s-using-the-urlconf">
<span id="using-the-urlconf"></span><h3>Using the URLconf<a class="headerlink" href="#using-the-urlconf" title="永久链接至标题">¶</a></h3>
<p>There are several ways to include the flat pages in your URLconf. You can
dedicate a particular path to flat pages:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^pages/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;django.contrib.flatpages.urls&#39;</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>You can also set it up as a &#8220;catchall&#8221; pattern. In this case, it is important
to place the pattern at the end of the other urlpatterns:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib.flatpages</span> <span class="kn">import</span> <span class="n">views</span>

<span class="c1"># Your other patterns here</span>
<span class="n">urlpatterns</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^(?P&lt;url&gt;.*/)$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">flatpage</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">If you set <a class="reference internal" href="../../settings/#std:setting-APPEND_SLASH"><code class="xref std std-setting docutils literal"><span class="pre">APPEND_SLASH</span></code></a> to <code class="docutils literal"><span class="pre">False</span></code>, you must remove the slash
in the catchall pattern or flatpages without a trailing slash will not be
matched.</p>
</div>
<p>Another common setup is to use flat pages for a limited set of known pages and
to hard code the urls, so you can reference them with the <a class="reference internal" href="../../templates/builtins/#std:templatetag-url"><code class="xref std std-ttag docutils literal"><span class="pre">url</span></code></a> template
tag:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib.flatpages</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^about-us/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">flatpage</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;/about-us/&#39;</span><span class="p">},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;about&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^license/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">flatpage</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;/license/&#39;</span><span class="p">},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;license&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="s-using-the-middleware">
<span id="using-the-middleware"></span><h3>Using the middleware<a class="headerlink" href="#using-the-middleware" title="永久链接至标题">¶</a></h3>
<p>The <a class="reference internal" href="#django.contrib.flatpages.middleware.FlatpageFallbackMiddleware" title="django.contrib.flatpages.middleware.FlatpageFallbackMiddleware"><code class="xref py py-class docutils literal"><span class="pre">FlatpageFallbackMiddleware</span></code></a>
can do all of the work.</p>
<dl class="class">
<dt id="django.contrib.flatpages.middleware.FlatpageFallbackMiddleware">
<em class="property">class </em><code class="descname">FlatpageFallbackMiddleware</code><a class="headerlink" href="#django.contrib.flatpages.middleware.FlatpageFallbackMiddleware" title="永久链接至目标">¶</a></dt>
<dd><p>Each time any Django application raises a 404 error, this middleware
checks the flatpages database for the requested URL as a last resort.
Specifically, it checks for a flatpage with the given URL with a site ID
that corresponds to the <a class="reference internal" href="../../settings/#std:setting-SITE_ID"><code class="xref std std-setting docutils literal"><span class="pre">SITE_ID</span></code></a> setting.</p>
<p>If it finds a match, it follows this algorithm:</p>
<ul class="simple">
<li>If the flatpage has a custom template, it loads that template.
Otherwise, it loads the template <code class="file docutils literal"><span class="pre">flatpages/default.html</span></code>.</li>
<li>It passes that template a single context variable, <code class="docutils literal"><span class="pre">flatpage</span></code>,
which is the flatpage object. It uses
<a class="reference internal" href="../../templates/api/#django.template.RequestContext" title="django.template.RequestContext"><code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code></a> in rendering the
template.</li>
</ul>
<p>The middleware will only add a trailing slash and redirect (by looking
at the <a class="reference internal" href="../../settings/#std:setting-APPEND_SLASH"><code class="xref std std-setting docutils literal"><span class="pre">APPEND_SLASH</span></code></a> setting) if the resulting URL refers to
a valid flatpage. Redirects are permanent (301 status code).</p>
<p>If it doesn&#8217;t find a match, the request continues to be processed as usual.</p>
<p>The middleware only gets activated for 404s &#8211; not for 500s or responses
of any other status code.</p>
</dd></dl>

<div class="admonition-flatpages-will-not-apply-view-middleware admonition">
<p class="first admonition-title">Flatpages will not apply view middleware</p>
<p class="last">Because the <code class="docutils literal"><span class="pre">FlatpageFallbackMiddleware</span></code> is applied only after
URL resolution has failed and produced a 404, the response it
returns will not apply any <a class="reference internal" href="../../../topics/http/middleware/#view-middleware"><span>view middleware</span></a>
methods. Only requests which are successfully routed to a view via
normal URL resolution apply view middleware.</p>
</div>
<p>Note that the order of <a class="reference internal" href="../../settings/#std:setting-MIDDLEWARE_CLASSES"><code class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></code></a> matters. Generally, you
can put
<a class="reference internal" href="#django.contrib.flatpages.middleware.FlatpageFallbackMiddleware" title="django.contrib.flatpages.middleware.FlatpageFallbackMiddleware"><code class="xref py py-class docutils literal"><span class="pre">FlatpageFallbackMiddleware</span></code></a> at the
end of the list. This means it will run first when processing the response, and
ensures that any other response-processing middlewares see the real flatpage
response rather than the 404.</p>
<p>For more on middleware, read the <a class="reference internal" href="../../../topics/http/middleware/"><em>middleware docs</em></a>.</p>
<div class="admonition-ensure-that-your-404-template-works admonition">
<p class="first admonition-title">Ensure that your 404 template works</p>
<p class="last">Note that the
<a class="reference internal" href="#django.contrib.flatpages.middleware.FlatpageFallbackMiddleware" title="django.contrib.flatpages.middleware.FlatpageFallbackMiddleware"><code class="xref py py-class docutils literal"><span class="pre">FlatpageFallbackMiddleware</span></code></a>
only steps in once another view has successfully produced a 404 response.
If another view or middleware class attempts to produce a 404 but ends up
raising an exception instead, the response will become an HTTP 500
(&#8220;Internal Server Error&#8221;) and the
<a class="reference internal" href="#django.contrib.flatpages.middleware.FlatpageFallbackMiddleware" title="django.contrib.flatpages.middleware.FlatpageFallbackMiddleware"><code class="xref py py-class docutils literal"><span class="pre">FlatpageFallbackMiddleware</span></code></a>
will not attempt to serve a flat page.</p>
</div>
</div>
</div>
<div class="section" id="s-how-to-add-change-and-delete-flatpages">
<span id="how-to-add-change-and-delete-flatpages"></span><h2>How to add, change and delete flatpages<a class="headerlink" href="#how-to-add-change-and-delete-flatpages" title="永久链接至标题">¶</a></h2>
<div class="section" id="s-via-the-admin-interface">
<span id="s-flatpages-admin"></span><span id="via-the-admin-interface"></span><span id="flatpages-admin"></span><h3>Via the admin interface<a class="headerlink" href="#via-the-admin-interface" title="永久链接至标题">¶</a></h3>
<p>If you&#8217;ve activated the automatic Django admin interface, you should see a
&#8220;Flatpages&#8221; section on the admin index page. Edit flatpages as you edit any
other object in the system.</p>
<p>The <code class="docutils literal"><span class="pre">FlatPage</span></code> model has an <code class="docutils literal"><span class="pre">enable_comments</span></code> field that isn&#8217;t used by
<code class="docutils literal"><span class="pre">contrib.flatpages</span></code>, but that could be useful for your project or third-party
apps. It doesn&#8217;t appear in the admin interface, but you can add it by
registering a custom <code class="docutils literal"><span class="pre">ModelAdmin</span></code> for <code class="docutils literal"><span class="pre">FlatPage</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.contrib.flatpages.admin</span> <span class="kn">import</span> <span class="n">FlatPageAdmin</span>
<span class="kn">from</span> <span class="nn">django.contrib.flatpages.models</span> <span class="kn">import</span> <span class="n">FlatPage</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="c1"># Define a new FlatPageAdmin</span>
<span class="k">class</span> <span class="nc">FlatPageAdmin</span><span class="p">(</span><span class="n">FlatPageAdmin</span><span class="p">):</span>
    <span class="n">fieldsets</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;sites&#39;</span><span class="p">)}),</span>
        <span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Advanced options&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s1">&#39;classes&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;collapse&#39;</span><span class="p">,</span> <span class="p">),</span>
            <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">(</span>
                <span class="s1">&#39;enable_comments&#39;</span><span class="p">,</span>
                <span class="s1">&#39;registration_required&#39;</span><span class="p">,</span>
                <span class="s1">&#39;template_name&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">}),</span>
    <span class="p">)</span>

<span class="c1"># Re-register FlatPageAdmin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">FlatPage</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">FlatPage</span><span class="p">,</span> <span class="n">FlatPageAdmin</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.9:</span> <p>The <code class="docutils literal"><span class="pre">enable_comments</span></code> field was removed from <code class="docutils literal"><span class="pre">FlatPageAdmin</span></code>.</p>
</div>
</div>
<div class="section" id="s-via-the-python-api">
<span id="via-the-python-api"></span><h3>Via the Python API<a class="headerlink" href="#via-the-python-api" title="永久链接至标题">¶</a></h3>
<dl class="class">
<dt id="django.contrib.flatpages.models.FlatPage">
<em class="property">class </em><code class="descname">FlatPage</code><a class="headerlink" href="#django.contrib.flatpages.models.FlatPage" title="永久链接至目标">¶</a></dt>
<dd><p>Flatpages are represented by a standard
<a class="reference internal" href="../../../topics/db/models/"><em>Django model</em></a>,
which lives in <a class="reference external" href="https://github.com/django/django/blob/master/django/contrib/flatpages/models.py">django/contrib/flatpages/models.py</a>. You can access
flatpage objects via the <a class="reference internal" href="../../../topics/db/queries/"><em>Django database API</em></a>.</p>
</dd></dl>

<div class="admonition-check-for-duplicate-flatpage-urls admonition">
<p class="first admonition-title">Check for duplicate flatpage URLs.</p>
<p class="last">If you add or modify flatpages via your own code, you will likely want to
check for duplicate flatpage URLs within the same site. The flatpage form
used in the admin performs this validation check, and can be imported from
<code class="docutils literal"><span class="pre">django.contrib.flatpages.forms.FlatpageForm</span></code> and used in your own
views.</p>
</div>
</div>
</div>
<div class="section" id="s-flatpage-templates">
<span id="flatpage-templates"></span><h2>Flatpage templates<a class="headerlink" href="#flatpage-templates" title="永久链接至标题">¶</a></h2>
<p>By default, flatpages are rendered via the template
<code class="file docutils literal"><span class="pre">flatpages/default.html</span></code>, but you can override that for a
particular flatpage: in the admin, a collapsed fieldset titled
&#8220;Advanced options&#8221; (clicking will expand it) contains a field for
specifying a template name. If you&#8217;re creating a flat page via the
Python API you can simply set the template name as the field
<code class="docutils literal"><span class="pre">template_name</span></code> on the <code class="docutils literal"><span class="pre">FlatPage</span></code> object.</p>
<p>Creating the <code class="file docutils literal"><span class="pre">flatpages/default.html</span></code> template is your responsibility;
in your template directory, just create a <code class="file docutils literal"><span class="pre">flatpages</span></code> directory
containing a file <code class="file docutils literal"><span class="pre">default.html</span></code>.</p>
<p>Flatpage templates are passed a single context variable, <code class="docutils literal"><span class="pre">flatpage</span></code>,
which is the flatpage object.</p>
<p>Here&#8217;s a sample <code class="file docutils literal"><span class="pre">flatpages/default.html</span></code> template:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">flatpage.title</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="cp">{{</span> <span class="nv">flatpage.content</span> <span class="cp">}}</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Since you&#8217;re already entering raw HTML into the admin page for a flatpage,
both <code class="docutils literal"><span class="pre">flatpage.title</span></code> and <code class="docutils literal"><span class="pre">flatpage.content</span></code> are marked as <strong>not</strong>
requiring <a class="reference internal" href="../../templates/language/#automatic-html-escaping"><span>automatic HTML escaping</span></a> in the
template.</p>
</div>
<div class="section" id="s-getting-a-list-of-flatpage-objects-in-your-templates">
<span id="getting-a-list-of-flatpage-objects-in-your-templates"></span><h2>Getting a list of <a class="reference internal" href="#django.contrib.flatpages.models.FlatPage" title="django.contrib.flatpages.models.FlatPage"><code class="xref py py-class docutils literal"><span class="pre">FlatPage</span></code></a> objects in your templates<a class="headerlink" href="#getting-a-list-of-flatpage-objects-in-your-templates" title="永久链接至标题">¶</a></h2>
<p>The flatpages app provides a template tag that allows you to iterate
over all of the available flatpages on the <a class="reference internal" href="../sites/#hooking-into-current-site-from-views"><span>current site</span></a>.</p>
<p>Like all custom template tags, you&#8217;ll need to <a class="reference internal" href="../../templates/language/#loading-custom-template-libraries"><span>load its custom
tag library</span></a> before you can use
it. After loading the library, you can retrieve all current flatpages
via the <a class="reference internal" href="#std:templatetag-get_flatpages"><code class="xref std std-ttag docutils literal"><span class="pre">get_flatpages</span></code></a> tag:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">flatpages</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">get_flatpages</span> <span class="k">as</span> <span class="nv">flatpages</span> <span class="cp">%}</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">page</span> <span class="k">in</span> <span class="nv">flatpages</span> <span class="cp">%}</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">page.url</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">page.title</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="section" id="s-displaying-registration-required-flatpages">
<span id="s-std:templatetag-get_flatpages"></span><span id="displaying-registration-required-flatpages"></span><span id="std:templatetag-get_flatpages"></span><h3>Displaying <code class="docutils literal"><span class="pre">registration_required</span></code> flatpages<a class="headerlink" href="#displaying-registration-required-flatpages" title="永久链接至标题">¶</a></h3>
<p>By default, the <a class="reference internal" href="#std:templatetag-get_flatpages"><code class="xref std std-ttag docutils literal"><span class="pre">get_flatpages</span></code></a> templatetag will only show
flatpages that are marked <code class="docutils literal"><span class="pre">registration_required</span> <span class="pre">=</span> <span class="pre">False</span></code>. If you
want to display registration-protected flatpages, you need to specify
an authenticated user using a <code class="docutils literal"><span class="pre">for</span></code> clause.</p>
<p>For example:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">get_flatpages</span> <span class="nv">for</span> <span class="nv">someuser</span> <span class="k">as</span> <span class="nv">about_pages</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>If you provide an anonymous user, <a class="reference internal" href="#std:templatetag-get_flatpages"><code class="xref std std-ttag docutils literal"><span class="pre">get_flatpages</span></code></a> will behave
the same as if you hadn&#8217;t provided a user &#8211; i.e., it will only show you
public flatpages.</p>
</div>
<div class="section" id="s-limiting-flatpages-by-base-url">
<span id="limiting-flatpages-by-base-url"></span><h3>Limiting flatpages by base URL<a class="headerlink" href="#limiting-flatpages-by-base-url" title="永久链接至标题">¶</a></h3>
<p>An optional argument, <code class="docutils literal"><span class="pre">starts_with</span></code>, can be applied to limit the
returned pages to those beginning with a particular base URL. This
argument may be passed as a string, or as a variable to be resolved
from the context.</p>
<p>For example:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">get_flatpages</span> <span class="s1">&#39;/about/&#39;</span> <span class="k">as</span> <span class="nv">about_pages</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">get_flatpages</span> <span class="nv">about_prefix</span> <span class="k">as</span> <span class="nv">about_pages</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">get_flatpages</span> <span class="s1">&#39;/about/&#39;</span> <span class="nv">for</span> <span class="nv">someuser</span> <span class="k">as</span> <span class="nv">about_pages</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-integrating-with-django-contrib-sitemaps">
<span id="integrating-with-django-contrib-sitemaps"></span><h2>Integrating with <a class="reference internal" href="../sitemaps/#module-django.contrib.sitemaps" title="django.contrib.sitemaps: A framework for generating Google sitemap XML files."><code class="xref py py-mod docutils literal"><span class="pre">django.contrib.sitemaps</span></code></a><a class="headerlink" href="#integrating-with-django-contrib-sitemaps" title="永久链接至标题">¶</a></h2>
<dl class="class">
<dt id="django.contrib.flatpages.sitemaps.FlatPageSitemap">
<em class="property">class </em><code class="descname">FlatPageSitemap</code><a class="reference internal" href="../../../_modules/django/contrib/flatpages/sitemaps/#FlatPageSitemap"><span class="viewcode-link">[源代码]</span></a><a class="headerlink" href="#django.contrib.flatpages.sitemaps.FlatPageSitemap" title="永久链接至目标">¶</a></dt>
<dd><p>The <a class="reference internal" href="#django.contrib.flatpages.sitemaps.FlatPageSitemap" title="django.contrib.flatpages.sitemaps.FlatPageSitemap"><code class="xref py py-class docutils literal"><span class="pre">sitemaps.FlatPageSitemap</span></code></a> class looks at all
publicly visible <a class="reference internal" href="#module-django.contrib.flatpages" title="django.contrib.flatpages: A framework for managing simple ?flat? HTML content in a database."><code class="xref py py-mod docutils literal"><span class="pre">flatpages</span></code></a> defined for the current
<a class="reference internal" href="../../settings/#std:setting-SITE_ID"><code class="xref std std-setting docutils literal"><span class="pre">SITE_ID</span></code></a> (see the <a class="reference internal" href="../sites/#module-django.contrib.sites" title="django.contrib.sites: Lets you operate multiple websites from the same database and Django project"><code class="xref py py-mod docutils literal"><span class="pre">sites</span> <span class="pre">documentation</span></code></a>) and creates an entry in the sitemap. These entries
include only the <a class="reference internal" href="../sitemaps/#django.contrib.sitemaps.Sitemap.location" title="django.contrib.sitemaps.Sitemap.location"><code class="xref py py-attr docutils literal"><span class="pre">location</span></code></a>
attribute &#8211; not <a class="reference internal" href="../sitemaps/#django.contrib.sitemaps.Sitemap.lastmod" title="django.contrib.sitemaps.Sitemap.lastmod"><code class="xref py py-attr docutils literal"><span class="pre">lastmod</span></code></a>,
<a class="reference internal" href="../sitemaps/#django.contrib.sitemaps.Sitemap.changefreq" title="django.contrib.sitemaps.Sitemap.changefreq"><code class="xref py py-attr docutils literal"><span class="pre">changefreq</span></code></a> or
<a class="reference internal" href="../sitemaps/#django.contrib.sitemaps.Sitemap.priority" title="django.contrib.sitemaps.Sitemap.priority"><code class="xref py py-attr docutils literal"><span class="pre">priority</span></code></a>.</p>
</dd></dl>

<div class="section" id="s-example">
<span id="example"></span><h3>Example<a class="headerlink" href="#example" title="永久链接至标题">¶</a></h3>
<p>Here&#8217;s an example of a URLconf using <a class="reference internal" href="#django.contrib.flatpages.sitemaps.FlatPageSitemap" title="django.contrib.flatpages.sitemaps.FlatPageSitemap"><code class="xref py py-class docutils literal"><span class="pre">FlatPageSitemap</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.contrib.flatpages.sitemaps</span> <span class="kn">import</span> <span class="n">FlatPageSitemap</span>
<span class="kn">from</span> <span class="nn">django.contrib.sitemaps.views</span> <span class="kn">import</span> <span class="n">sitemap</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>

    <span class="c1"># the sitemap</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^sitemap\.xml$&#39;</span><span class="p">,</span> <span class="n">sitemap</span><span class="p">,</span>
        <span class="p">{</span><span class="s1">&#39;sitemaps&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;flatpages&#39;</span><span class="p">:</span> <span class="n">FlatPageSitemap</span><span class="p">}},</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;django.contrib.sitemaps.views.sitemap&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gis/" class="btn btn-neutral float-right" title="GeoDjango" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../contenttypes/" class="btn btn-neutral" title="The contenttypes framework" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版权所有 Django Software Foundation and contributors.
      最后更新于 Apr 27, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.10.dev20160423182652',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>